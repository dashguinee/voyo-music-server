# VOYO MUSIC - SINGLE SOURCE OF TRUTH
**Generated**: January 17, 2026
**Status**: 70% Complete
**Live URL**: https://voyo-music.vercel.app

---

## QUICK STATUS

| Metric | Value |
|--------|-------|
| Total Commits | 340 |
| Development Days | 34 (Dec 4, 2025 - Jan 6, 2026) |
| Canonized Tracks | 122,402 |
| Build Status | SUCCESS (1.7MB) |
| Deployment | Vercel LIVE |
| Uncommitted Files | 10+ |

---

# PART 1: CHRONOLOGICAL COMMIT HISTORY

## Overview
- **First Commit**: December 4, 2025 - "VOYO Genesis"
- **Latest Commit**: January 6, 2026 - "Add search-based Moments Discovery crawlers"
- **Total Commits**: 340
- **Contributor**: DASH (Diop Abdoul Aziz)

---

## Phase 1: VOYO Genesis & Foundation (Dec 4-11, 2025)
**24 commits** - Core infrastructure, orchestrator architecture, audio streaming

### Key Commits
| Hash | Message | Impact |
|------|---------|--------|
| ca5fec7 | VOYO Genesis: Refactor complete | 4-layer orchestrator, 3-tab system (MUSIC\|FEED\|CREATE) |
| a70d6da | VOYO Genesis Blueprint updates | 4-layer architecture documented |
| b811a64 | LED Strip Portal System | CD flying animations, drag-to-zone |
| e410e0e | Security hardening (20-Engineer Audit) | Production-grade security |
| a18fc0a | Audio streaming now works on production | Railway deployment fixed |
| 2fc2aa0 | 139kbps Opus highest quality streaming | PO token plugin integration |

### Architecture Established
- 4-layer orchestrator: Layer 1 (z-0) → Layer 2 (z-10) → Layer 4 Nav (z-30) → Layer 3 Upload (z-50)
- VoyoVerticalFeed with solid bg-black (fully hides Layer 1 when active)
- TikTok-style cultural feed
- Creator upload flow

---

## Phase 2: Advanced UI & Portal Magic (Dec 13-14, 2025)
**20 commits** - Premium UI components, portal animations, optimizations

### Key Commits
| Hash | Message | Impact |
|------|---------|--------|
| e038317 | IFrame-first playback with Boost HD | YouTube iframe integration |
| d3621f2 | Portal Belt - watch dial carousel | Infinite scroll system |
| 77c78fa | Z-Agent Army: Complete production hardening | Multi-agent security audit |
| 82eb0cd | PWA install button with VOYO logo | Progressive Web App |
| ade8c9d | Expert panel optimizations | Haptics, media session, memoization |

### Features Built
- Portal belt UI (infinite carousel)
- PWA installation support
- Haptic feedback system
- Backdrop animation library (particles, aurora, custom image)
- Memory leak prevention

---

## Phase 3: Major Feature Integration (Dec 14-19, 2025)
**44 commits** - Personalization, home feed, albums, swipe gestures, DJ migration

### Key Commits
| Hash | Message | Impact |
|------|---------|--------|
| 02f3237 | Major feature upgrade | Personalization, home feed, albums, scroll |
| a7fa4ad | Swipe-to-queue | Flying card animation |
| 9fdc24b | VOYO DJ migration | African Bass audio enhancement |
| ac4dd32 | Two-handed ergonomic controls | Wazzguan DJ chat |
| e478ffe | Neon Billboard playlist cards | Animated taglines |
| 128e025 | Intent Engine | Dynamic track pool system |
| da7d465 | VOYO Universe system | voyomusic.com/username |
| cc67773 | Wire full state sync | Likes, now_playing, portal |
| 5dcc63e | Community reaction system | MixBoard integration |

### Features Built
- MixBoard intent system (5 vibe sliders)
- DAHUB social hub (Instagram notes + Snapchat activity)
- Universe system (shareable profiles)
- Playlists with cloud sync
- Reaction system (fire, oye, love)

---

## Phase 4: Feed & Discovery System (Dec 19-24, 2025)
**33 commits** - Music snippet feed, video content, AI DJ system, collective intelligence

### Key Commits
| Hash | Message | Impact |
|------|---------|--------|
| cce2e0c | Music Snippet Feed | Auto-play, visualizer, auto-advance |
| 20facaa | Video Snippets | Actual music videos in feed |
| ff3c491 | Shazam killer + lyrics + portal chat | Multi-feature integration |
| 2aca466 | Voice DJ mode + DynamicIsland | Voice interaction |
| 6468fcf | VOYO Ship v1.0 | First production release |
| 1502d7e | THE WINNING TEASER FORMULA | Variety creates discovery |
| a464252 | Intelligent DJ with real-time YouTube | Discovery integration |
| b524422 | Collective intelligence flywheel | Central DJ system |

### Features Built
- Snippet feeds (audio + video)
- Central DJ with Gemini 2.0 integration
- Collective intelligence tracking
- Teaser formula (variety-based discovery)
- Pool-based curation

---

## Phase 5: Vibes System & Content Curation (Dec 24-25, 2025)
**74 commits** - Browse by Vibes, Lottie animations, vibe cards, section curation

### Key Commits
| Hash | Message | Impact |
|------|---------|--------|
| 07985ac | Add Vibes tab to search | Vibe discovery |
| 2995702 | Browse by Vibes section | Homepage integration |
| f68d387 | Lottie animations to vibe icons | Premium animations |
| 3b52cb2 | Vibe card styling | 3D pop effect |
| 654d365 | Polish MiniPlayer with premium UX | Player refinement |
| 041f1b6 | African Vibes video section | Video integration |
| 619f7a5 | Premium video player with toggle | Video mode |
| df8d796 | Real artist avatars, profile sync | DAHUB enhancement |
| df18576 | Complete background playback | QR friend invites |

### Features Built
- 5 vibe cards (Afro Heat, Chill, Party, Workout, Late Night)
- Lottie animations (fire, workout flexing, etc.)
- MiniPlayer with boost button
- African Vibes video section
- Background playback

---

## Phase 6: Video Intelligence & TIVI+ Integration (Dec 26-28, 2025)
**33 commits** - Video modes, landscape/portrait support, TIVI+ content

### Key Commits
| Hash | Message | Impact |
|------|---------|--------|
| c56c2fc | Portrait video mode + Landscape video-first | Dual orientation |
| 1e1b157 | Video Intelligence - The Collective Brain | Supabase sync |
| 9c1b67e | YouTube suggestion interceptor | VOYO overlay on YouTube |
| 8f99523 | TIVI+ cross-promo section | Cross-product promotion |
| 63e34f9 | Real TMDB content | Movie/TV integration |
| 2373383 | Time Tunnel vinyl carousel | Premium UI |
| cc2c281 | Heavy Rotation circles | Listening history |
| b415d81 | LLM-powered section curator | Smart curation |

### Features Built
- Portrait/landscape video modes
- YouTube interception overlay
- Video Intelligence API (collective brain)
- TIVI+ cross-promotion
- TMDB content integration
- Heavy Rotation section

---

## Phase 7: Playback Architecture & iframe Consolidation (Dec 28-30, 2025)
**15 commits** - Single audio source, video sync, iframe management

### Key Commits
| Hash | Message | Impact |
|------|---------|--------|
| b6f60a1 | Single audio source architecture | All iframes muted |
| 0468cd0 | Extract YouTubeIframe component | Refactored AudioPlayer |
| 10b8b05 | TV-style video mode | Dynamic zoom + overlays |
| 25aafdc | LRCLIB integration | Free synced lyrics |
| 4a0f20d | Cache LRCLIB results to Supabase | Lyrics persistence |

### Architecture Decisions
- Single audio source truth (AudioPlayer handles all audio)
- All visible iframes muted
- Video syncs with AudioPlayer position
- Lyrics cached to Supabase

---

## Phase 8: Core Feature Wiring & Player Philosophy (Dec 29-30, 2025)
**21 commits** - MCP flows, feed infrastructure, section-aware playback

### Key Commits
| Hash | Message | Impact |
|------|---------|--------|
| e1bfd67 | MCP click flows + feed infrastructure | Core wiring |
| ea14634 | Section-aware full/mini player | UX philosophy |
| 481dbde | Consolidate playback: atomic playTrack() | Simplified playback |
| c7a6208 | Fix video mode leakage | Single global iframe |
| 7cb571e | Smooth portrait/landscape transitions | Z-layering |

### Features Built
- Section-aware player (full vs mini based on context)
- Atomic playTrack() action
- Portrait/landscape transitions
- MCP click handling

---

## Phase 9: Direct Messaging & Hub System (Dec 31 - Jan 1, 2026)
**21 commits** - Portal Chat, DMs, backend wiring, artist tier canonization

### Key Commits
| Hash | Message | Impact |
|------|---------|--------|
| ff2513b | Wire Portal Chat to Supabase Realtime | Real-time chat |
| 5b93c23 | DirectMessageChat component | DM interface |
| 82b5578 | Wire DMs to DynamicIsland | Notifications |
| 0888555 | DJ Brain architecture | Database sync |
| 769709b | VOYO Mass Database Feeders | 122K tracks loaded |
| 3977dce | Cultural Weapon - Artist Tiers | Canon levels |
| 144213b | VOYO Canonizer | 122K tracks classified |
| bc17565 | Artist Tier System v5 | Cultural canonization |

### Features Built
- Portal Chat (real-time messaging)
- Direct Messages
- DynamicIsland notifications
- 122K track canonization
- Artist tier system (A/B/C/D)

---

## Phase 10: YouTube Audio Conquest & Workflow Automation (Jan 2-6, 2026)
**55 commits** - GitHub Actions workflows, parallel downloads, moments discovery

### Key Commits
| Hash | Message | Impact |
|------|---------|--------|
| dfe8894 | GitHub Actions for parallel audio conquest | Infrastructure |
| a746590 | Base64 cookies for YAML parsing | Cookie handling |
| 9ae0b01 | Create 20 separate conquest workflows | Parallel workers |
| 048c3ef | Multi-cookie support | 1 YouTube account per worker |
| 51ab8fb | Feed Conquest GitHub Actions | Content ingestion |
| 49cd34d | Rename Feed → Moments | Discovery + Conquest |
| 557799b | Add 20 Gemini keys with rotation | AI scaling |
| c5eb90c | LOOP mode - 6hr continuous discovery | Autonomous operation |
| 9d9756a | Search-based Moments Discovery | Latest crawlers |

### Infrastructure Built
- 20 parallel GitHub Actions workflows
- Multi-account YouTube strategy
- Gemini key rotation (20 keys)
- 6-hour continuous discovery loops
- Search-based creator discovery

---

# PART 2: CURRENT ARCHITECTURE

## Tech Stack

| Layer | Technology |
|-------|------------|
| Framework | React 19.2.0 + TypeScript 5.9 |
| Build | Vite 7.2.4 |
| State | Zustand 5.0.9 |
| Styling | Tailwind CSS 4.1.17 |
| Animation | Framer Motion 12.23.25 + Lottie |
| Icons | Lucide React 0.555.0 |
| Database | Supabase (auth, sync, realtime) |
| Audio/Video | YouTube IFrame, Web Audio API |
| AI | Gemini 2.0 Flash |

---

## Directory Structure

```
src/
├── App.tsx                      # Main app shell, mode switching
├── components/                  # 47 React components
│   ├── voyo/                   # Main VOYO player (7 files)
│   │   ├── PortraitVOYO.tsx    # Phone portrait mode
│   │   ├── LandscapeVOYO.tsx   # Landscape video mode
│   │   ├── VideoMode.tsx       # Full-screen video
│   │   ├── VoyoPortraitPlayer.tsx
│   │   ├── VoyoSplash.tsx      # Water drop intro
│   │   ├── OyoIsland.tsx       # DynamicIsland
│   │   ├── navigation/         # Bottom nav
│   │   ├── feed/               # Vertical feed (8 files)
│   │   └── upload/             # Creator upload
│   ├── classic/                # Spotify-style (6 files)
│   ├── player/                 # Playback controls (5 files)
│   ├── search/                 # Search overlay
│   ├── universe/               # Profile/portal
│   ├── portal/                 # Chat
│   ├── chat/                   # DM interface
│   ├── playlist/               # Playlist modal
│   ├── profile/                # User profile
│   ├── backgrounds/            # Animated backgrounds
│   └── ui/                     # Reusable atoms
│
├── store/                      # 8 Zustand stores
│   ├── playerStore.ts         # Core playback (1,176 lines)
│   ├── universeStore.ts       # Auth & profile (755 lines)
│   ├── preferenceStore.ts     # Learning & personalization
│   ├── intentStore.ts         # MixBoard vibe intent
│   ├── reactionStore.ts       # Social reactions
│   ├── trackPoolStore.ts      # Dynamic track pool
│   ├── playlistStore.ts       # User playlists
│   └── downloadStore.ts       # Offline caching
│
├── services/                   # 24 business logic services
│   ├── api.ts                 # Hybrid API (Worker + Fly.io)
│   ├── audioEngine.ts         # Web Audio boost profiles
│   ├── personalization.ts     # Scoring engine
│   ├── centralDJ.ts           # AI DJ curation
│   ├── poolCurator.ts         # Pool maintenance
│   ├── trackVerifier.ts       # Unplayable detection
│   ├── intelligentDJ.ts       # Advanced mixing
│   ├── videoIntelligence.ts   # Collective brain
│   ├── lyricsEngine.ts        # Synced lyrics
│   └── ...
│
├── brain/                      # 7 files - Intelligent DJ
│   ├── VoyoBrain.ts           # Gemini orchestration
│   ├── SignalBuffer.ts        # User intent capture
│   └── ...
│
├── scouts/                     # 3 files - Autonomous discovery
│   ├── HungryScouts.ts        # Periodic agents
│   └── DatabaseFeeder.ts      # Collective brain population
│
├── knowledge/                  # 4 files - Music knowledge
│   ├── KnowledgeStore.ts      # Vibe profiles
│   ├── MoodTags.ts            # 12 mood types
│   └── artistTiers.ts         # Artist ranking
│
├── hooks/                      # 5 custom hooks
├── lib/                        # 3 utilities (NEW: vibeEngine, dash-auth)
├── utils/                      # 10+ utility functions
├── types/                      # TypeScript definitions
└── data/                       # Static seed data
```

---

## Core Stores

### playerStore (1,176 lines)
- **State**: currentTrack, isPlaying, progress, queue, history, viewMode, boostProfile, bufferHealth
- **Key Actions**: playTrack(), nextTrack(), addToQueue(), refreshRecommendations()
- **Persistence**: localStorage (voyo-player-state)

### universeStore (755 lines)
- **State**: isLoggedIn, currentUsername, portalSession, viewingUniverse
- **Key Actions**: signup/login (PIN-based), syncToCloud/FromCloud, openPortal
- **Security**: AES-GCM encryption for backups

### trackPoolStore
- **State**: pool (80+ tracks), pooledByVibe, poolHealth
- **Key Actions**: addToPool(), rescorePool(), startPoolMaintenance()
- **Auto-curation**: Every 5 minutes

### intentStore
- **State**: 5 MixBoard sliders (Hype, Chill, Afro, RnB, etc.)
- **Weight**: 60% of personalization score

---

## Services Architecture

### API Flow
```
User Search → api.ts → Fly.io Backend (yt-dlp) → YouTube
               ↓
         Cloudflare Worker (edge streaming)
               ↓
         YouTube IFrame (fallback)
```

### Personalization Formula
```
Score = Intent (60%) + Behavior (40%)

Intent = MixBoard slider weights
Behavior = Likes (100) + Completions (50) + Reactions (10) - Skips (-30)
```

### Brain Session Structure
```
VoyoBrain.generateSession() →
  - Main Queue (20 tracks)
  - Shadow Sessions (5 × 15 = 75 tracks)
  - HOT Belt (5 tracks)
  - DISCOVERY Belt (5 tracks)
  - Transition Rules
  - DJ Moments
```

---

## Features Implemented

### Playback
- YouTube iframe streaming
- Adaptive quality (network-aware)
- Offline caching (IndexedDB)
- Media Session API (system controls)
- SKEEP mode (1x, 2x, 4x, 8x)
- Boost profiles (boosted, calm, voyex, xtreme)

### Discovery
- Pool-based recommendations (80+ songs)
- Intent-first personalization (60% MixBoard + 40% history)
- AI curation (Gemini 2.0 Flash)
- Section curation (West African, Classics, Trending)

### Social
- Real-time reactions (fire, oye, love)
- Portal sharing (voyomusic.com/username)
- Direct messaging
- DynamicIsland notifications

### UI Modes
- Portrait VOYO (main phone UI)
- Landscape VOYO (video focus)
- Video Mode (full-screen)
- Classic Mode (Spotify-style)
- Feed Mode (TikTok vertical)

---

# PART 3: UNCOMMITTED WORK

## Summary
- **Modified Files**: 2 (App.tsx, UniversePanel.tsx)
- **Untracked Files**: 10+
- **New Lines**: ~2,500+
- **Key Feature**: DASH Universal Auth + Track Enrichment

---

## Modified Files

### src/App.tsx (+4 lines)
Import and render DashAuthBadge in header:
```typescript
import { DashAuthBadge, useDashCitizen } from './lib/dash-auth';
// ...
<DashAuthBadge productCode="V" />
```

### src/components/universe/UniversePanel.tsx (+97/-102 lines)
Replace VOYO auth with DASH ID login:
- New "Sign in with DASH ID" flow
- Input for DASH ID (e.g., "00AAD")
- Input for 6-digit PIN
- Connects to DASH Command Center Supabase

---

## New Files

### src/lib/dash-auth.tsx (312 lines)
**Universal DASH authentication bridge**
- `signInWithDashId(coreId, pin, productCode)` - Authenticate
- `DashAuthBadge` - Shows citizen ID (e.g., "V00AAD")
- `useDashCitizen()` - React hook
- Cross-tab synchronization
- Product codes: E, DC, V, TV, AMP, etc.

### src/lib/vibeEngine.ts (607 lines)
**Vibe query engine - transforms vibes to database queries**
- 36+ vibes across 6 categories
- `getAllVibes()` - List available vibes
- `getTracksForVibe(vibeId, limit)` - Query Supabase
- `getCuratedMix(vibeId, limit)` - Blend connected vibes
- `suggestVibesForTrack(track)` - Discover vibes

**Vibe Categories**:
- Regional: Conakry Nights, Lagos Nights, Johannesburg Heat
- Mood: Chill Vibes, Afro Heat, Late Night, Workout
- Era: Golden Era, Throwback Thursday, New Wave
- Activity: Party Mode, Study Flow, Morning Rise
- Cultural: Motherland Roots, Diaspora Connection

### scripts/enrichment/build_artist_master.py (421 lines)
**Phase 1 enrichment - build artist database**
- 64 A-tier artists (global icons)
- 46 B-tier artists (regional stars)
- Cultural significance scores
- Genre-to-vibe mappings

### scripts/enrichment/gemini_batch_classifier.py (423 lines)
**Phase 3 enrichment - AI classification**
- Gemini 2.0 Flash batch processing
- 50 tracks per batch
- Returns: tier, era, genre, vibe_scores, cultural_tags

### scripts/enrichment/enrich-by-artist.cjs (268 lines)
**Apply artist enrichment to Supabase**
- Loads artist_master.json
- Updates matching tracks
- Batches of 50

### data/artist_master.json (88 KB)
**Master artist database**
- 110 artists (64 A-tier, 46 B-tier)
- Countries: NG, ZA, TZ, CD, GN, SN, CI, KE, ML, ET, GH
- Vibe scores per genre

### data/genre_vibe_defaults.json (8 KB)
**30+ genres mapped to vibe scores**
```json
{
  "afrobeats": {"afro_heat": 85, "chill": 35, "party": 75, "workout": 70, "late_night": 45},
  "amapiano": {"afro_heat": 70, "chill": 50, "party": 90, "workout": 60, "late_night": 80}
}
```

### supabase/migrations/002_enrichment_schema.sql (294 lines)
**Database schema for enrichment**
- Columns: artist_tier, era, primary_genre, cultural_tags, aesthetic_tags, vibe_scores
- Functions: get_vibe_tracks(), get_enrichment_stats()
- Table: vibe_feedback (community corrections)

### ENRICHMENT_STRATEGY.md (545 lines)
**5-phase enrichment pipeline documentation**
- Phase 1: Artist Master (150K tracks, $0)
- Phase 2: Title Patterns (80K tracks, $0)
- Phase 3: Gemini AI (100K tracks, ~$50)
- Phase 4: Community Feedback (ongoing)
- Phase 5: Vibe Score Blending

---

## Recommended Commits

### Commit 1: DASH Universal Authentication
```
Files: src/App.tsx, src/lib/dash-auth.tsx, src/components/universe/UniversePanel.tsx
Message: feat: Integrate DASH Universal Authentication into VOYO
```

### Commit 2: Vibe Engine
```
Files: src/lib/vibeEngine.ts
Message: feat: Implement vibe query engine with 36+ vibes
```

### Commit 3: Enrichment Strategy
```
Files: ENRICHMENT_STRATEGY.md, .vercelignore
Message: docs: Add ENRICHMENT_STRATEGY for 324K track classification
```

### Commit 4: Enrichment Scripts
```
Files: scripts/enrichment/*, data/artist_master.json, data/genre_vibe_defaults.json
Message: feat: Add Phase 1-3 enrichment pipeline scripts
```

### Commit 5: Database Schema
```
Files: supabase/migrations/002_enrichment_schema.sql
Message: feat: Add enrichment schema to video_intelligence table
```

---

# PART 4: NEXT STEPS TO SHIP

## Immediate (Today)
1. Commit uncommitted work (5 staged commits)
2. Deploy to Vercel (automatic on push)
3. Test DASH auth flow
4. Run Phase 1 enrichment (enrich-by-artist.cjs)

## This Week
5. Run Phase 2 title pattern enrichment
6. Run Phase 3 Gemini batch classification (~$50)
7. Wire vibeEngine to UI (Vibe Mode)
8. Configure voyomusic.com domain

## Blockers
- R2 audio count needs verification
- DASH Command Center must be live for auth
- Gemini API key needed for Phase 3

---

# APPENDIX: KEY FILES REFERENCE

| File | Purpose | Lines |
|------|---------|-------|
| src/store/playerStore.ts | Core playback engine | 1,176 |
| src/store/universeStore.ts | Auth & profile sync | 755 |
| src/lib/vibeEngine.ts | Vibe query system | 607 |
| src/brain/VoyoBrain.ts | AI DJ orchestration | ~400 |
| src/services/personalization.ts | Scoring engine | ~300 |
| src/lib/dash-auth.tsx | DASH auth bridge | 312 |

---

**Last Updated**: January 17, 2026
**Author**: ZION SYNAPSE
**For**: DASH (Diop Abdoul Aziz)
